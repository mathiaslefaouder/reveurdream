function httpGet(theUrl) {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("GET", theUrl, false); // false for synchronous request
    xmlHttp.send(null);
    return xmlHttp.responseText;
}

import {Ion, Viewer, Color, PinBuilder, Cartesian3, VerticalOrigin, buildModuleUrl } from "cesium";

// Your access token can be found at: https://cesium.com/ion/tokens.
// This is the default access token
Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJhYzNkMmMxNi04NDM3LTQyNzEtYjBlNy05NTAxNjVjMGVhMDEiLCJpZCI6OTA1MzQsImlhdCI6MTY1MDQzNTIyMn0.P6exO2RJvDDe-6SgILWjoj92WeEaeRkPdWEeP6YhfYw';

// Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
var viewer = new Viewer('cesiumContainer', {
    animation: false,
    baseLayerPicker: false,
    fullscreenButton: false,
    geocoder: false,
    homeButton: false,
    sceneModePicker: false,
    camera: false,
    selectionIndicator: false,
    timeline: false,
    useDefaultRenderLoop: true,
    navigationHelpButton: false,
    scene3DOnly: true,
    shouldAnimate: true,
    sun: false,
    skyBox: false,
    skyAtmosphere: false,
    requestRenderMode: true,
    contextOptions: {
        webgl: {
            alpha: true,
        },
    }
});
const {scene, entities, camera} = viewer;

//Set the background of the scene to transparent
scene.backgroundColor = Color.clone(Color.TRANSPARENT).withAlpha(0.0);
scene.screenSpaceCameraController.minimumZoomDistance = 120000;
scene.screenSpaceCameraController.maximumZoomDistance = 6378137 * 2;
scene.globe.enableLighting = true;
scene.globe.dynamicAtmosphereLighting = true;
//HDR needs to be disable for transparent backgrounds
viewer.highDynamicRange = false;
camera.flyTo({
    destination : Cartesian3.fromDegrees(2.3491, 48.8579, 150000.0 *60)
});


const pinBuilder = new PinBuilder();

let data = httpGet('/test');
data = JSON.parse(data)



function init() {
    const bluePin = entities.add({
        name: data.name,
        description: '<div class="popup-dream">\n' +
            '    <div class="overlay">\n' +
            '    </div>\n' +
            '    <div class="popup-dream-text"><div>\n' +
            '            <p class="popup-dream-text-date">Date du songe</p>\n' +
            '            <div class="popup-dream-text-icons">\n' +
            '                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 383.95 383.95"><path d="M0,204V180c.83-6.4,1.41-12.83,2.52-19.17C10.1,117.34,29.78,80.33,62.34,50.47a187.49,187.49,0,0,1,97-47.56C166.16,1.74,173.08,1,180,0h24c6.54.84,13.12,1.45,19.61,2.56,39.46,6.79,73.71,24,102.36,52,29.41,28.75,47.85,63.44,55,104,1.25,7.09,2,14.27,3,21.41v24c-.22,1.09-.5,2.17-.67,3.26-1.55,9.84-2.43,19.83-4.71,29.49A191.48,191.48,0,0,1,225,381c-7,1.19-14,2-21,2.94H180a18.11,18.11,0,0,0-2.86-.64A170.91,170.91,0,0,1,125.5,372Q24.25,331.66,2.92,224.65C1.58,217.83,1,210.87,0,204ZM187.05,318.79c22.95,0,40.43-3.13,56.9-10.63,28.32-12.9,48.34-33.14,55.48-64.36,2.17-9.5-4.47-15.9-13.82-12.82a288.52,288.52,0,0,1-76.69,13.83c-24.79,1.22-49.47.18-73.83-4.61-12.57-2.47-24.86-6.27-37.29-9.42-8.93-2.26-15.26,3.76-13.4,12.57C88.77,264,99.62,280.63,116,293.65A116.65,116.65,0,0,0,187.05,318.79Zm50.66-171.28A24.59,24.59,0,1,0,262.28,123,24.66,24.66,0,0,0,237.71,147.51Zm-91.45.23a24.55,24.55,0,1,0-24.57,24.54A24.61,24.61,0,0,0,146.26,147.74Z"/></svg>\n' +
            '                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 265.7 299.69">\n' +
            '                    <path d="M84.76,299.69c-4.9-1.7-9.83-3.32-14.68-5.16-1.45-.55-2.67-1.69-3.91-2.5,4.57-1.96,9.01-3.6,13.21-5.72,4.76-2.41,5.84-5.39,3.82-8.94-2.03-3.56-5.05-4.02-9.63-1.46-18.5,10.33-40.83,.81-45.32-19.71-2.57-11.75,.99-21.92,10.04-30.08,1.5-1.35,3.45-3.18,3.53-4.88,.1-2-1.08-4.9-2.66-5.91-1.52-.97-4.69-.75-6.38,.23-2.74,1.59-5.05,4.07-7.17,6.5-1.5,1.72-2.76,1.9-4.83,1.24-18.1-5.77-26.5-27.76-16.54-44.19,.8,.51,1.62,.98,2.38,1.53,8.32,6.02,17.62,8.65,27.84,7.99,4.04-.26,6.16-2.44,6.1-6.09-.06-3.82-2.38-6.2-6.61-5.81-13.76,1.27-27.59-8.19-31.29-22.19-4.48-16.96,8.19-35.05,25.67-36.43,1.24-.1,2.51-.23,3.68-.6,3.13-.97,4.28-3.4,3.89-6.42-.39-3.05-2.2-5.31-5.48-4.96-5.39,.57-10.73,1.61-16.47,2.51-2.25-7.05-1.25-14.28,1.84-21.3,5.89-13.35,20.49-21.51,34.08-19.17,15.56,2.67,26.76,14.28,28.22,29.27,.08,.87,.2,1.74,.38,2.59,.78,3.63,3.21,5.38,6.73,4.89,3.39-.48,5.01-2.53,4.98-6.29-.16-18.47-14.32-36.37-32.64-41.11-3-.78-6.12-1.31-9.21-1.49-2.18-.13-2.94-.97-3.53-2.93-3.21-10.75,2.02-22.76,12.26-27.81,10.25-5.05,23.07-1.7,29.65,7.75,.64,.92,1.15,1.94,1.81,2.84,2.08,2.8,4.96,3.39,7.91,1.68,2.84-1.64,3.86-4.69,2.3-7.72-3.11-6.03-7.71-10.72-13.56-14.16-.95-.56-1.94-1.07-3.19-1.76,3.06-7.35,8.41-11.81,15.94-13.38,15.58-3.24,28.83,7.69,28.83,23.61,0,78.88,0,157.76,0,236.65,0,19.87-13.37,35.24-33.13,38.21-.72,.11-1.42,.43-2.12,.65h-6.75Zm-17.16-83.49c-2.34-.15-4.82-.47-7.29-.42-3.95,.09-6.28,2.42-6.28,5.96,0,3.56,2.32,5.79,6.21,5.98,17.06,.82,27.46,13.59,24.64,30.26-.76,4.47,.91,7.36,4.6,7.97,3.91,.65,6.41-1.23,7.23-5.7,2.73-14.95-1.8-27.23-13.5-36.99-1.43-1.19-2.67-3.37-2.84-5.2-1.3-14.01,5.16-24.92,18.01-31.04,4.18-1.99,5.47-4.74,3.89-8.31-1.59-3.59-4.5-4.54-8.78-2.62-11.95,5.37-20.01,14.3-23.66,26.89-1.23,4.25-1.51,8.77-2.24,13.21Zm3.55-71.48c14.51,.13,27.85-6.39,35.69-16.93,2.72-3.66,2.58-6.88-.4-9.2-2.92-2.27-6.28-1.62-9.05,1.75-11.89,14.44-29.84,16.7-44.86,5.65-3.62-2.66-6.69-2.4-9.1,.76-2.31,3.03-1.78,5.83,1.74,8.65,7.89,6.31,16.9,9.4,25.98,9.32Z"/><path d="M174.04,299.69c-3.47-.92-7.05-1.58-10.4-2.82-15.43-5.7-24.85-19.29-24.85-35.67-.01-79.38-.01-158.76,0-238.15,0-11.11,6.93-19.59,18.01-22.3,10.49-2.57,20.91,1.92,25.87,11.15,.29,.54,.48,1.13,.49,1.15-4.45,3.96-8.77,7.64-12.88,11.53-1.32,1.25-2.21,3.02-3.1,4.65-1.9,3.48-1.13,6.58,1.94,8.35,3.16,1.82,6.22,1.08,8.3-2.35,4.87-8.06,11.95-12.3,21.33-12.27,15.09,.05,26.17,15.2,22.09,29.79-.63,2.26-1.54,3.13-4.01,3.29-22.12,1.46-40.27,19.58-41.37,41.1-.26,5.14,1.32,7.5,5.25,7.84,4.01,.34,6.17-1.95,6.71-7.16,1.46-13.9,10.46-24.91,23.84-28.65,11.79-3.3,22.4-.61,31.13,7.86,8.78,8.51,12.02,19.03,9.43,31.14-.07,.33-.39,.6-.43,.66-4.92-.93-9.61-2.11-14.38-2.63-4.75-.52-7.15,1.46-7.44,5.25-.29,3.87,2.1,6.29,6.88,6.61,7.62,.51,14.01,3.59,19.09,9.16,8.33,9.14,10.48,19.7,5.95,31.24-4.3,10.95-15.28,18.18-26.92,18.25-1.13,0-2.25-.05-3.38-.03-3.8,.06-6,2.03-6.21,5.51-.22,3.72,1.82,6.13,5.72,6.42,8.83,.66,17.14-1.13,24.76-5.73,1.91-1.15,3.73-2.44,5.59-3.67,7.3,9.56,5.91,26.15-3.68,35.76-3.56,3.57-8.56,5.79-13.09,8.27-.91,.5-2.98-.23-4.01-1.04-2.44-1.92-4.44-4.4-6.86-6.35-3.17-2.54-6.33-2.21-8.59,.53-2.3,2.78-1.92,6.25,1.26,8.83,7.77,6.29,11.82,14.35,11.86,24.35,.09,23.12-24.16,37.79-44.7,27.05-1.11-.58-2.16-1.26-3.29-1.78-3.09-1.41-5.94-.42-7.63,2.58-1.59,2.82-1.19,5.98,1.65,7.54,4.01,2.21,8.32,3.87,12.53,5.71,.89,.39,1.88,.55,3.13,.9-5.54,5.05-12.24,6.48-18.85,8.13h-6.75Zm23.52-83.49c-.07-1.13-.12-2.23-.2-3.32-1.2-17.26-9.79-29.46-25.36-36.78-4.21-1.98-7.21-.94-8.77,2.65-1.57,3.58-.28,6.29,3.95,8.3,12.73,6.04,19.13,16.71,18.02,30.67-.15,1.94-1.38,4.3-2.87,5.55-11.68,9.79-16.23,22.05-13.48,37.01,.83,4.49,3.31,6.35,7.23,5.69,3.69-.62,5.36-3.53,4.59-7.98-2.87-16.55,7.62-29.4,24.67-30.25,3.87-.19,6.21-2.47,6.18-6.02-.03-3.38-2.28-5.78-5.95-5.92-2.59-.1-5.19,.24-8.02,.4Zm-5.09-71.4c10.14,.27,20.05-2.76,28.52-9.95,3.01-2.56,3.29-5.34,1.09-8.19-2.26-2.93-5.48-3.53-8.49-1.02-14.52,12.09-36.18,8.19-45.77-5.63-.83-1.2-2.69-2.65-3.83-2.47-2.23,.36-4.77,1.33-6.3,2.9-1.97,2.02-.99,4.67,.64,6.82,8.35,11.03,19.53,16.68,34.15,17.53Z"/><path class="b" d="M67.6,216.19c.72-4.44,1.01-8.96,2.24-13.21,3.65-12.59,11.71-21.52,23.66-26.89,4.28-1.92,7.19-.98,8.78,2.62,1.58,3.57,.29,6.32-3.89,8.31-12.86,6.12-19.31,17.03-18.01,31.04,.17,1.83,1.41,4.01,2.84,5.2,11.71,9.76,16.24,22.04,13.5,36.99-.82,4.48-3.31,6.35-7.23,5.7-3.69-.62-5.35-3.5-4.6-7.97,2.82-16.67-7.58-29.44-24.64-30.26-3.89-.19-6.22-2.42-6.21-5.98,0-3.54,2.34-5.88,6.28-5.96,2.47-.05,4.96,.27,7.29,.42Z"/><path class="b" d="M71.15,144.72c-9.08,.08-18.1-3.01-25.98-9.32-3.52-2.82-4.05-5.61-1.74-8.65,2.41-3.16,5.49-3.42,9.1-.76,15.03,11.05,32.97,8.79,44.86-5.65,2.78-3.37,6.13-4.02,9.05-1.75,2.98,2.32,3.12,5.54,.4,9.2-7.84,10.55-21.18,17.06-35.69,16.93Z"/><path class="b" d="M197.56,216.19c2.83-.16,5.43-.5,8.02-.4,3.67,.14,5.92,2.54,5.95,5.92,.03,3.54-2.32,5.82-6.18,6.02-17.05,.84-27.54,13.7-24.67,30.25,.77,4.45-.9,7.35-4.59,7.98-3.92,.66-6.4-1.2-7.23-5.69-2.75-14.95,1.8-27.22,13.48-37.01,1.49-1.25,2.72-3.61,2.87-5.55,1.11-13.96-5.29-24.63-18.02-30.67-4.23-2.01-5.52-4.71-3.95-8.3,1.57-3.59,4.56-4.63,8.77-2.65,15.57,7.32,24.16,19.52,25.36,36.78,.08,1.1,.13,2.2,.2,3.32Z"/><path class="b" d="M192.47,144.79c-14.62-.85-25.8-6.5-34.15-17.53-1.63-2.15-2.61-4.79-.64-6.82,1.53-1.57,4.07-2.54,6.3-2.9,1.14-.18,3,1.27,3.83,2.47,9.59,13.81,31.25,17.72,45.77,5.63,3.01-2.51,6.23-1.91,8.49,1.02,2.2,2.85,1.92,5.63-1.09,8.19-8.47,7.19-18.38,10.22-28.52,9.95Z"/>\n' +
            '                </svg>\n' +
            '            </div>\n' +
            '            <h2>La caverne violette</h2>\n' +
            '            <p>Exsistit autem hoc loco quaedam quaestio subdifficilis, num quando amici novi, digni amicitia, veteribus sint anteponendi, ut equis vetulis teneros anteponere solemus. Indigna homine dubitatio! Non enim debent esse amicitiarum sicut aliarum rerum satietates; veterrima quaeque, ut ea vina, quae vetustatem ferunt, esse debet suavissima; verumque illud est, quod dicitur, multos modios salis simul edendos esse, ut amicitiae munus expletum sit.</p>\n' +
            '            <p>Et licet quocumque oculos flexeris feminas adfatim multas spectare cirratas, quibus, si nupsissent, per aetatem ter iam nixus poterat suppetere liberorum, ad usque taedium pedibus pavimenta tergentes iactari volucriter gyris, dum exprimunt innumera simulacra, quae finxere fabulae theatrales.</p>\n' +
            '            <div class="close-popup">x</div>\n' +
            '        </div></div>\n' +
            '</div>',
        position: Cartesian3.fromDegrees(-75.170726, 39.9208667),
        billboard: {
            image: pinBuilder.fromColor(Color.ROYALBLUE, 48).toDataURL(),
            verticalOrigin: VerticalOrigin.BOTTOM,
        },
    });
}

export {init}